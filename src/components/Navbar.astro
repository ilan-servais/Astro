---
import Button from '@components/ui/Button.astro';
import ToggleTheme from '@components/ui/ToggleTheme.astro';
import { Astronav, MenuIcon, MenuItems } from 'astro-navbar';

// Obtenir le chemin actuel de la page
const currentPath = Astro.url.pathname;
const isHomePage = currentPath === '/' || currentPath === '';
const isCareerPage = currentPath.includes('/career');

// Adapter les liens en fonction de la page actuelle
const menuitems = [
	{
		title: 'Home',
		path: '/',
		showOnlyOnCareer: true
	},
	{
		title: 'About',
		path: isHomePage ? '#about' : '/#about',
	},
	{
		title: 'Projects',
		path: isHomePage ? '#projects' : '/#projects',
	},
	{
		title: 'Career',
		path: '/career',
		hideOnCareer: true
	},
	{
		title: 'Contact',
		path: isHomePage ? '#contact' : '/#contact',
	},
];

// Filtrer les éléments à afficher
const filteredItems = menuitems.filter(item => {
	if (isCareerPage && item.hideOnCareer) return false;
	if (!isCareerPage && item.showOnlyOnCareer) return false;
	return true;
});
---

<header data-testId="header" class="my-5 flex flex-col items-center justify-between lg:flex-row">
	<Astronav>
		<div class="flex w-full items-center justify-between lg:w-auto">
			<a href="/CV.pdf" target="_blank" rel="noopener noreferrer">
				<Button size={'sm'} name="Download CV">Download CV</Button>
			</a>
			<div class="block lg:hidden">
				<MenuIcon class="h-4 w-4 text-black dark:text-white" />
			</div>
		</div>
		<MenuItems class="mt-2 hidden w-full lg:mt-0 lg:flex lg:w-auto">
			<ul class="flex flex-col lg:flex-row lg:gap-3">
				{
					filteredItems.map((item) => (
						<li>
							<a
								aria-label="navigation link"
								href={item.path}
								class="flex py-2 text-black hover:text-orange dark:text-white dark:hover:text-orange lg:px-3"
							>
								{item.title}
							</a>
						</li>
					))
				}
				<li><ToggleTheme /></li>
			</ul>
		</MenuItems>
	</Astronav>
</header>

<style>
	/* Styles spécifiques pour assurer la cohérence entre les pages */
	header {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: space-between;
	}

	@media (min-width: 1024px) {
		header {
			flex-direction: row;
		}
	}
	
	/* Style pour le bouton Download CV */
	:global(header a button) {
		font-weight: 500;
		letter-spacing: 0.025em;
	}
	
	/* Assure l'espacement correct pour le menu */
	ul {
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	
	@media (min-width: 1024px) {
		ul {
			flex-direction: row;
			gap: 0.75rem;
		}
	}
</style>
